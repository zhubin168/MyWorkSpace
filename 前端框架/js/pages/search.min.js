"use strict";!function(e){function t(){return{Units:[],HasMoreUnit:!1,Activities:[],HasMoreActivity:!1,TelMeetings:[],HasMoreTelMeeting:!1,VideoSurveys:[],HasMoreVideoSurvey:!1,Articles:[],HasMoreArticle:!1,PrivateMeetings:[],HasMorePrivateMeeting:!1}}{var s={ALL:0,COMPANY:1,ACTIVITY:2,TEL_MEETING:3,VIDEO_SURVEY:4,ARTICLE:5,PRIVATE_MEETING:6};new Vue({el:"#contentBody",data:function(){return{loading:null,searchTypeConst:s,type:e.type,keyWord:e.keyWord,pageIndex:1,searchResult:t(),loadListComplete:!1,contentWaypoint:null}},computed:{hasUnit:function(){return this.searchResult.Units&&this.searchResult.Units.length>0},hasActivity:function(){return this.searchResult.Activities&&this.searchResult.Activities.length>0},hasTelMeeting:function(){return this.searchResult.TelMeetings&&this.searchResult.TelMeetings.length>0},hasVideoSurvey:function(){return this.searchResult.VideoSurveys&&this.searchResult.VideoSurveys.length>0},hasArticle:function(){return this.searchResult.Articles&&this.searchResult.Articles.length>0},hasPrivateMeeting:function(){return this.searchResult.PrivateMeetings&&this.searchResult.PrivateMeetings.length>0},isSearchAll:function(){return this.type===this.searchTypeConst.ALL}},mixins:[jhbCore.vueMixin],created:function(){this.loadContent()},mounted:function(){this.setTabLocation()},methods:{setTabLocation:function(){var e=document.querySelector(".jhb__live_on"),t=e.offsetLeft;document.querySelector(".search-tab").scrollLeft=t-window.screen.width+e.offsetWidth},formatKeyword:function(e){var t=this.keyWord;if(!e)return null;if(!t)return e;var s=e.replace(t,'<span class="highlight">'+t+"</span>");return s},submitForm:function(e){this.keyWord||this.toast("请输入搜索内容"),e.preventDefault(),e.stopPropagation()},isTabActivity:function(e){return this.type===e},loadContent:function(){var e=this,t=jhbGlobal.jhbApi+"/search/search";e.keyWord&&(1===this.pageIndex&&this.showLoading(),this.httpPost(t,{type:this.type,pageIndex:this.pageIndex,keyWord:this.keyWord}).then(function(t){if(jhbCore.destroyWaypoint(e.contentWaypoint),t.code&&t.data){var s=!1;switch(e.type){case e.searchTypeConst.ALL:e.searchResult=t.data;break;case e.searchTypeConst.COMPANY:s=t.data.Units&&t.data.Units.length>0,s&&(e.searchResult.Units=e.searchResult.Units.concat(t.data.Units));break;case e.searchTypeConst.ACTIVITY:s=t.data.Activities&&t.data.Activities.length>0,s&&(e.searchResult.Activities=e.searchResult.Activities.concat(t.data.Activities));break;case e.searchTypeConst.TEL_MEETING:s=t.data.TelMeetings&&t.data.TelMeetings.length>0,s&&(e.searchResult.TelMeetings=e.searchResult.TelMeetings.concat(t.data.TelMeetings));break;case e.searchTypeConst.VIDEO_SURVEY:s=t.data.VideoSurveys&&t.data.VideoSurveys.length>0,s&&(e.searchResult.VideoSurveys=e.searchResult.VideoSurveys.concat(t.data.VideoSurveys));break;case e.searchTypeConst.ARTICLE:s=t.data.Articles&&t.data.Articles.length>0,s&&(e.searchResult.Articles=e.searchResult.Articles.concat(t.data.Articles));break;case e.searchTypeConst.PRIVATE_MEETING:s=t.data.PrivateMeetings&&t.data.PrivateMeetings.length>0,s&&(e.searchResult.PrivateMeetings=e.searchResult.PrivateMeetings.concat(t.data.PrivateMeetings))}e.isSearchAll||(s?e.$nextTick(function(){e.pageIndex++,e.initContentWaypoint()}):e.loadListComplete=!0)}else e.loadListComplete=!0}))},initContentWaypoint:function(){this.contentWaypoint=jhbCore.initWaypoint(document.getElementById("searchResultBox"),this.loadContent)},doSearch:function(e){this.pageIndex=1,this.type=e,this.searchResult=t(),this.loadContent(),this.replaceHistory()},keyWordChange:function(e){13===e.keyCode&&(this.pageIndex=1,this.searchResult=t(),this.loadContent(),this.replaceHistory())},replaceHistory:function(){var t=e.url+"?type="+this.type+"&keyWord="+this.keyWord;history.replaceState(null,"搜索",t)},cancelSearch:function(){window.history.go(document.referrer&&document.referrer.toLowerCase().indexOf("search/search")>-1?-2:-1)}}})}}(searchConfig);